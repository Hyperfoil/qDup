# qDup command documentation for LSP hover support
# Generated from docs/reference/command/*.adoc

abort = End the current run with an optional error message. Aborted runs will still download queued files and run cleanup scripts.
add-prompt = Add a custom shell prompt so qDup can detect when a non-standard terminal session (e.g. psql, jboss-cli) is ready for the next command.
countdown = Decrease a named counter starting from an initial value. Child 'then' commands are invoked each time after the counter reaches zero.
ctrlC = Send a ctrl+C interrupt to the SSH terminal, typically used to stop a long-running command such as 'tail -f'.
ctrl/ = Send a ctrl+/ signal to the SSH terminal.
ctrl\\ = Send a ctrl+\\ signal to the SSH terminal.
ctrlU = Send a ctrl+U signal to the SSH terminal to clear the current input line.
ctrlZ = Send a ctrl+Z signal to the SSH terminal to suspend the current foreground process.
done = Tell qDup that the current phase is done and cancel any other scripts still running. Deprecated; do not use unless absolutely necessary.
download = Copy a file from the remote host to the local qDup run directory immediately. Accepts a remote path, optional local destination, and optional max-size.
echo = Write the input from the previous command to the qDup console log, primarily used for debugging scripts.
exec = Run a shell command as an SSH exec channel with the default environment and home folder, without affecting the current terminal session.
for-each = Iterate over the input (or an explicit list) and run the 'then' commands for each entry, setting a named state variable to the current item.
js = Execute arbitrary JavaScript code with access to the input from the previous command and the current state. Runs 'then' on truthy return, 'else' otherwise.
json = Evaluate a JSONPath expression against the input (assumed to be JSON). Runs 'then' commands with matched values, or 'else' if no match.
log = Write a message string to the qDup run.log file, supporting state variable substitution.
parse = Use the Hyperfoil parse library to parse the input from the previous command.
queue-download = Queue a file on the remote host for download after the run or cleanup stage completes, rather than downloading immediately.
read-signal = Check whether a named signal has been fully signalled. Runs 'then' commands if reached, or 'else' commands if not yet reached.
read-state = Evaluate a state expression and run the 'then' commands if the result is non-null and non-empty, otherwise run the 'else' commands.
regex = Match a Java regex pattern against the input from the previous command. Named capture groups are added to script state. Runs 'then' on match, 'else' otherwise.
repeat-until = Repeat the 'then' commands in a loop until the named signal is fully signalled. Always include a 'sleep' inside to avoid a tight loop.
script = Invoke another named script using the same SSH terminal. Supports 'async' option to run in a separate terminal with independent state.
send-text = Send text to the SSH terminal without waiting for a prompt response, designed for use inside 'watch', 'timer', or 'on-signal' blocks.
set-signal = Initialize or reset the expected signal count for a named coordination signal, used when qDup cannot automatically calculate the count.
set-state = Set a state variable to a given value, or to the input from the previous command if no value is specified. Supports RUN. and HOST. prefixes for scope.
sh = Execute a shell command on the remote SSH terminal. Supports prompt-response mapping, exit code checking, and 'ignore-exit-code' option.
signal = Signal a named coordination point to notify other scripts that a specific execution milestone has been reached.
sleep = Pause the current script for a specified duration. Accepts milliseconds or human-readable durations (e.g. '1h 10m 20.5s').
upload = Copy a file from the local machine running qDup to the remote host. Accepts a local path and optional remote destination.
wait-for = Pause the current script until the named coordination point has been fully signalled by other scripts.
xml = Read or modify XML documents using XPath expressions. Supports set, add child, delete, set attribute, and read-to-state operations.

# Command parameter documentation
sh.command = The shell command to execute on the remote terminal.
sh.prompt = Map of expected prompts to responses, used for interactive commands.
sh.ignore-exit-code = Set to true to skip exit code checking for this command.
sh.silent = Suppress command output in the log.
set-state.key = The state variable name to set. Use RUN. or HOST. prefix for scope.
set-state.value = The value to assign. If omitted, uses input from the previous command.
set-state.separator = Character to separate state key from default value (default ':').
set-state.autoConvert = Set to false to disable automatic type conversion of text.
regex.pattern = The Java regex pattern to match against input.
regex.miss = Set to true to invert the match (run 'then' when pattern does NOT match).
regex.autoConvert = Set to false to disable automatic type conversion of captured groups.
download.path = Remote file path to download.
download.destination = Local destination path (default: run directory).
download.max-size = Maximum file size to download.
upload.path = Local file path to upload.
upload.destination = Remote destination path (default: home folder).
for-each.name = State variable name for the current iteration item.
for-each.input = Explicit input to iterate over (default: previous command output).
exec.command = The command to execute via SSH exec channel.
exec.async = Set to true to run asynchronously without waiting for completion.
exec.silent = Suppress command output in the log.
abort.message = Error message to include when aborting the run.
abort.skip-cleanup = Set to true to skip cleanup scripts when aborting.
countdown.name = Name of the countdown counter.
countdown.initial = Initial counter value.
set-signal.name = Name of the coordination signal.
set-signal.count = Expected number of signal calls.
set-signal.reset = Set to true to reset an existing signal counter.
script.name = Name of the script to invoke.
script.async = Set to true to run in a separate terminal.
wait-for.name = Name of the signal to wait for.
wait-for.initial = Initial signal count (overrides automatic calculation).
xml.path = Path to the XML file.
xml.operations = List of XPath operations to perform.
queue-download.path = Remote file path to queue for download.
queue-download.destination = Local destination path.
queue-download.max-size = Maximum file size to download.
add-prompt.prompt = The prompt pattern to recognize.
add-prompt.is-shell = Whether this prompt is a shell prompt (default: false).
